<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Четыре участка</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; background: black; color: white; font-family: 'Arial', sans-serif; text-align: center; }
        .container { width: 100vw; height: 100vh; display: flex; flex-direction: column; align-items: center; overflow: hidden; }
        .sections { width: 100vw; height: 100vh; overflow: hidden !important; }
        .section { width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; font-size: 28px; font-weight: bold; scroll-snap-align: start; position: relative; flex-direction: column; }
        header { position: absolute; top: 0; width: 100%; display: flex; justify-content: space-between; padding: 20px; font-size: 20px; background: rgba(0, 0, 0, 0.6); border-bottom: 2px solid white; }
        .nav { display: flex; gap: 20px; cursor: pointer; }
        .animated-text { font-size: 24px; font-weight: bold; color: #00ccff; text-shadow: 0 0 10px #00ccff; margin-top: 50px; }
        .text-box { background: rgba(255, 255, 255, 0.1); padding: 10px; border-radius: 10px; max-width: 80%; font-size: 16px; opacity: 0; transition: opacity 2s ease-in-out; margin-top: 20px; }
        .arrow { position: fixed; bottom: 20px; right: 20px; font-size: 30px; cursor: pointer; user-select: none; width: 50px; height: 50px; background: white; color: black; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 10px rgba(255, 255, 255, 0.8); transition: transform 0.2s; }
        .arrow:hover { transform: scale(1.1); }
        .arrow-up { bottom: 80px; }
        footer { width: 100%; text-align: center; padding: 10px; font-size: 18px; display: none; }
        .strike { text-decoration: line-through; opacity: 0.5; transition: opacity 1s ease-in-out; }
        #heart-container { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100vw; height: 100vh; padding: 10px; gap: 10px; }
        #heartCanvas { border: 2px solid white; width: 90vw; max-width: 90%; height: 50vh; max-height: 50%; }
        button { background-color: #00ccff; color: white; padding: 10px 15px; font-size: 16px; border: none; cursor: pointer; margin: 5px; border-radius: 5px; transition: background-color 0.3s ease; width: 80vw; max-width: 250px; }
        button:hover { background-color: #0088cc; }
        @media (max-width: 600px) { 
            #heartCanvas { width: 85vw; height: 45vh; max-width: 85%; max-height: 45%; } 
            button { width: 90vw; max-width: 280px; font-size: 14px; padding: 8px 12px; } 
        }
        @media (max-width: 400px) { 
            #heartCanvas { width: 95vw; height: 40vh; max-width: 95%; max-height: 40%; } 
            button { width: 95vw; max-width: 260px; font-size: 13px; padding: 7px 10px; } 
        }
        #section4 img {
            width: 100%;
            max-height: 40vh;
            object-fit: cover;
        }

        #section4 .animated-text {
            margin-top: 20px;
            font-size: 5vw; 
            font-weight: bold;
            text-align: center;
        }

        #section4 .animated-text span {
            display: block; 
        }

        #playMusic {
            background-color: #ff4d4d;
            color: white;
            padding: 10px 15px;
            font-size: 4vw;
            border: none;
            cursor: pointer;
            margin-top: 20px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            width: 80%;
            max-width: 250px;
        }

        #playMusic:hover {
            background-color: #cc0000;
        }

        @media (max-width: 600px) {
            #section4 img {
                max-height: 35vh;
            }

            #section4 .animated-text {
                font-size: 6vw;
            }

            #playMusic {
                font-size: 5vw;
                padding: 8px 12px;
            }
        }

    </style>    
</head>
<body>
    <audio id="background-music" src="img/nice.mp3" loop></audio>
    <div class="container">
        <div class="sections" id="sections">
            <div class="section" id="section1">
                <header>
                    <div class="nav">
                        <span>О нас</span>
                        <span id="clearMemory">Очистка памяти</span>
                    </div>
                </header>
                <div class="animated-text" id="animatedText"></div>
                <div class="text-box" id="textBox">
                    Знаешь, может это и не какой-то суперский праздник, да и в принципе не праздник, но это повод подарить тебе вот такую валентинку, хыхыхвахыва. Этот сайт написан для тебя, здесь задействовано несколько языков программирования, я просто хочу тебе подарить положительные эмоции или как-то порадовать. В общем, я старался.
                </div>
            </div>
            <div class="section" id="section2">Красивый текст, наполненный смыслом и вдохновением</div>
            <div class="section" id="section3">
                <div class="animated-text" id="animatedText2">Ого, смотри!!</div>
                <div id="heart-container">
                    <canvas id="heartCanvas" width="800" height="800"></canvas>
                    <div>
                        <button id="startButton">Запустить</button>
                        <button id="resetButton">Очистить</button>
                    </div>
                </div>
            </div>
            
            <div class="section" id="section4">
                <img src="img/sf.jpg" alt="SF">
                <div class="animated-text">
                    <span style="color: white;">Ты со мной</span>
                    <span style="color: red;">- сердцем и душой</span>
                </div>
                <button id="playMusic">КЛИИИК</button>
                <audio id="serdMusic" src="img/serd.m4a"></audio>
            
        </div>
        <div class="arrow arrow-up" id="arrowUp" style="display: none;">&uarr;</div>
        <div class="arrow" id="arrowDown">&darr;</div>
    </div>
    <script>
        let currentSection = 0;
        const sections = document.getElementById("sections");
        const footer = document.getElementById("footer");
        const textElement = document.getElementById("animatedText");
        const music = document.getElementById("background-music");
        const textBox = document.getElementById("textBox");
    
        const text1 = "It was nice ";
        const textStrike = "while it lasted";
        const text2 = "but I don't agree that it would be like that.";
        
        function typeText(element, text, delay = 100) {
            return new Promise(resolve => {
                let index = 0;
                const interval = setInterval(() => {
                    if (index < text.length) {
                        element.innerHTML += text[index];
                        index++;
                    } else {
                        clearInterval(interval);
                        resolve();
                    }
                }, delay);
            });
        }
        
        async function animateText() {
            await typeText(textElement, text1);
            const strikeSpan = document.createElement("span");
            strikeSpan.classList.add("strike");
            strikeSpan.textContent = textStrike;
            textElement.appendChild(strikeSpan);
            await new Promise(resolve => setTimeout(resolve, 3000));
            strikeSpan.style.opacity = "0";
            await new Promise(resolve => setTimeout(resolve, 1000));
            textElement.removeChild(strikeSpan);
            await typeText(textElement, text2);
            textBox.style.opacity = "1"; 
        }
    
        document.addEventListener("click", () => {
            music.play().catch(err => console.log("Ошибка автозапуска музыки", err));
        });
    
        animateText();
        
        function updateArrows() {
            document.getElementById("arrowUp").style.display = currentSection > 0 ? "flex" : "none";
            document.getElementById("arrowDown").style.display = currentSection < 3 ? "flex" : "none";
            footer.style.display = currentSection === 3 ? "block" : "none";
        }
    
        document.getElementById("arrowDown").addEventListener("click", function() {
            if (currentSection < 3) {
                currentSection++;
                sections.scrollTo({ top: currentSection * window.innerHeight, behavior: 'smooth' });
                updateArrows();
            }
        });
        
        document.getElementById("arrowUp").addEventListener("click", function() {
            if (currentSection > 0) {
                currentSection--;
                sections.scrollTo({ top: currentSection * window.innerHeight, behavior: 'smooth' });
                updateArrows();
            }
        });
    
        clearMemory.addEventListener("click", () => {
            window.location.href = "al.html";
        });
    
        document.getElementById("sections").addEventListener("scroll", function () {
            if (currentSection === 0) {
                music.play().catch(err => console.log("Ошибка автозапуска музыки", err));
            } else {
                music.pause();
            }
        });

        document.getElementById("startButton").addEventListener("click", function() {
            startDrawing();
        });
    
        document.getElementById("resetButton").addEventListener("click", function() {
            resetDrawing();
        });
        document.getElementById("playMusic").addEventListener("click", function() {
            document.getElementById("serdMusic").play();
        });

        let drawingInterval;
        let isDrawing = false;

        function startDrawing() {
            const canvas = document.getElementById("heartCanvas");
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const a = (k) => 15 * Math.sin(k) ** 3;
            const b = (k) => 12 * Math.cos(k) - 5 * Math.cos(2 * k) - 2 * Math.cos(3 * k) - Math.cos(4 * k);

            ctx.strokeStyle = "red";
            ctx.lineWidth = 2;
            ctx.beginPath();

            let i = 0;
            const totalPoints = 6000;
            const duration = 15000;
            const intervalTime = duration / totalPoints;

            function drawHeart() {
                if (i <= totalPoints) {
                    const x = a(i) * 20 + canvas.width / 2;
                    const y = -b(i) * 20 + canvas.height / 3;
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                    ctx.stroke();
                    i++;
                } else {
                    clearInterval(drawingInterval);
                }
            }

            if (!isDrawing) {
                isDrawing = true;
                drawingInterval = setInterval(drawHeart, intervalTime);
            }
        }

        function resetDrawing() {
            const canvas = document.getElementById("heartCanvas");
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            clearInterval(drawingInterval);
            isDrawing = false;
        }

    
        updateArrows();
    </script>
    
</body>
</html>